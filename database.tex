\section{Database and features}
\par
The classifier described in this paper was tested on a set of samples provided by the Bitdefender Cyber Threat Intelligence Laboratory. The initial dataset consisted of 217,557 Office files and VBA projects (.doc, .docx, .xls, .xlsx) collected from June 2017 to May 2019, 176,314 malicious and 41,243 benign. In the further presentation of the features and samples selection we will use the word “token” to describe a an entity delimited by whitespaces. The samples were passed through a filter which removed documents whose macros had 32 tokens or less, because we considered that those files do not provide relevant information for our training process.
\par
As a result of the filtering process, the number of malicious samples was unchanged and the number of benign samples was reduced to 38,668. For the training process, we kept all the bening samples and selected 10,000 malicious samples in a random fashion.
\par
The features used in the training process have been extracted by various processing methods applied to the tokens found in the macro code of the Office files. This static approach of the features extraction is motivated by the need of accommodating certain performance parameters. In order to create a model that is as generic as possible, we extracted properties that are specific to clean samples, to malicious ones and properties which can describe both classes of samples. We arrived at a set of 536 features which describe general characteristics of the macro code (for example, the number of variables containing digits in their name), obfuscation features (for example, the number of statements in an assignment) but they also describe behavioral characteristic such as a function call with suspicious parameters.
\par
Due to the aforementioned performance restrictions, we will use only boolean features. This method also reduces the space needed to store the values of the features. Because some these values are not inherently boolean, the features need to be discretized. For example, we observed that in the case of some malicious samples, a higher number of small functions is present in malicious samples than in benign ones. This information led us to the selection of 12 intervals which represent the values of the feature in a way that provides more relevant data. (Table I)
\par
By discretizing the values, from an initial set of 536 features, we arrived at a feature vector close of 2977 properties. By design, our approach will use only 256 features from the initial 3000. These features are chosen using a process named Conditional Mutual Information Maximization, because we want our model to be constructed with features which bring maximum information gain.
Exemplu de ciat \cite{MicrosoftURL}
Db and features